/* ============================================
   MOBILE OPTIMIZATIONS
   ============================================ */

/* Base mobile improvements */
@media (max-width: 768px) {
  /* Larger touch targets */
  button, 
  [role="button"],
  input[type="checkbox"],
  input[type="radio"] {
    min-height: 44px !important;
    min-width: 44px !important;
    padding: 12px 16px !important;
    font-size: 16px !important;
  }

  /* Larger text inputs to prevent zoom on iOS */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  textarea {
    font-size: 16px !important;
    min-height: 44px !important;
    padding: 12px 16px !important;
    border-radius: 12px !important;
  }

  /* Navigation improvements */
  .nav-bottom {
    height: 80px !important;
    padding: 12px 16px !important;
  }

  .nav-bottom button {
    min-height: 56px !important;
    min-width: 56px !important;
    border-radius: 16px !important;
    font-size: 12px !important;
  }

  /* Panel spacing for mobile */
  section[aria-label] {
    margin: 16px auto 100px !important;
    padding: 20px 16px !important;
    border-radius: 20px !important;
  }

  /* EisenhowerPanel mobile optimizations */
  .eh-panel {
    padding: 16px !important;
    border-radius: 20px !important;
  }

  .eh-note {
    width: 110px !important;
    height: 110px !important;
    border-radius: 16px !important;
    font-size: 11px !important;
    padding: 8px !important;
  }

  /* Toolbar buttons */
  .eh-toolbar button {
    min-height: 48px !important;
    min-width: 48px !important;
    border-radius: 12px !important;
    font-size: 14px !important;
  }

  /* Quick input mobile */
  .eh-quick-input {
    padding: 16px !important;
    border-radius: 20px !important;
  }

  .eh-quick-input input {
    min-height: 48px !important;
    border-radius: 12px !important;
    font-size: 16px !important;
  }

  .eh-quick-input button {
    min-height: 48px !important;
    min-width: 48px !important;
    border-radius: 12px !important;
  }

  /* Composer mobile */
  .eh-composer {
    border-radius: 16px !important;
    min-width: 140px !important;
    min-height: 140px !important;
  }

  .eh-composer textarea {
    font-size: 12px !important;
    border-radius: 12px !important;
  }

  /* Settings mobile */
  .settings-grid {
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }

  .theme-button {
    min-height: 80px !important;
    padding: 20px !important;
    border-radius: 16px !important;
  }

  .theme-button svg {
    width: 32px !important;
    height: 32px !important;
  }

  /* Notification mobile */
  .notification-toast {
    margin: 0 16px 12px 16px !important;
    padding: 16px !important;
    border-radius: 16px !important;
    font-size: 15px !important;
  }

  .notification-toast button {
    min-height: 36px !important;
    min-width: 36px !important;
    border-radius: 8px !important;
  }
}

/* Small mobile devices */
@media (max-width: 480px) {
  /* Even larger touch targets */
  button, 
  [role="button"] {
    min-height: 48px !important;
    min-width: 48px !important;
    padding: 14px 18px !important;
  }

  /* Larger navigation */
  .nav-bottom {
    height: 88px !important;
  }

  .nav-bottom button {
    min-height: 60px !important;
    min-width: 60px !important;
  }

  /* Larger text */
  body {
    font-size: 16px !important;
    line-height: 1.6 !important;
  }

  h1 { font-size: 28px !important; }
  h2 { font-size: 24px !important; }
  h3 { font-size: 20px !important; }

  /* Notes even larger */
  .eh-note {
    width: 120px !important;
    height: 120px !important;
    font-size: 12px !important;
  }

  /* Panels full width */
  section[aria-label] {
    margin: 12px !important;
    border-radius: 16px !important;
  }
}

/* Landscape mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .nav-bottom {
    height: 64px !important;
    padding: 8px 16px !important;
  }

  .nav-bottom button {
    min-height: 48px !important;
    min-width: 48px !important;
  }

  /* Adjust panel margins for landscape */
  section[aria-label] {
    margin: 8px auto 80px !important;
  }

  /* Smaller notes in landscape to fit more */
  .eh-note {
    width: 100px !important;
    height: 100px !important;
  }
}

/* Touch-specific enhancements */
@media (hover: none) and (pointer: coarse) {
  /* Remove hover effects on touch devices */
  button:hover,
  [role="button"]:hover {
    transform: none !important;
    scale: none !important;
  }

  /* Add touch feedback instead */
  button:active,
  [role="button"]:active {
    transform: scale(0.96) !important;
    transition: transform 0.1s ease !important;
  }

  /* Better focus for touch */
  button:focus,
  [role="button"]:focus {
    outline: 3px solid var(--accent) !important;
    outline-offset: 3px !important;
  }

  /* Prevent text selection during touch interactions */
  .eh-note,
  .eh-grid,
  .nav-bottom,
  .eh-toolbar {
    -webkit-user-select: none !important;
    user-select: none !important;
    -webkit-touch-callout: none !important;
  }
}

/* High DPI displays (retina) */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  /* Sharper borders */
  button,
  [role="button"],
  .eh-note,
  .eh-panel {
    border-width: 0.5px !important;
  }

  /* Crisp icons */
  svg {
    shape-rendering: geometricPrecision !important;
  }
}

/* Safe area adjustments for notched devices */
@supports (padding: max(0px)) {
  .nav-bottom {
    padding-bottom: max(12px, env(safe-area-inset-bottom)) !important;
    padding-left: max(16px, env(safe-area-inset-left)) !important;
    padding-right: max(16px, env(safe-area-inset-right)) !important;
  }

  section[aria-label] {
    margin-top: max(16px, env(safe-area-inset-top)) !important;
    padding-left: max(16px, env(safe-area-inset-left)) !important;
    padding-right: max(16px, env(safe-area-inset-right)) !important;
  }
}

/* Reduce motion on mobile if requested */
@media (prefers-reduced-motion: reduce) and (max-width: 768px) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  button:active {
    transform: none !important;
  }
}

/* Dark mode adjustments for mobile */
@media (max-width: 768px) and (prefers-color-scheme: dark) {
  /* Darker backgrounds for better contrast on mobile */
  .eh-panel {
    background: rgba(0, 0, 0, 0.8) !important;
  }

  .eh-note {
    background: rgba(255, 255, 255, 0.08) !important;
    border-color: rgba(255, 255, 255, 0.12) !important;
  }

  button,
  [role="button"] {
    background: rgba(255, 255, 255, 0.06) !important;
    border-color: rgba(255, 255, 255, 0.12) !important;
  }
}

/* Accessibility improvements for mobile */
@media (max-width: 768px) {
  /* Larger focus indicators */
  *:focus {
    outline-width: 3px !important;
    outline-offset: 3px !important;
  }

  /* Better contrast for text */
  body {
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
  }

  /* Ensure minimum contrast ratios */
  .eh-note {
    color: contrast(var(--note-bg), white, black) !important;
  }
}

/* Performance optimizations for mobile */
@media (max-width: 768px) {
  /* Hardware acceleration for smoother animations */
  .eh-note,
  button,
  [role="button"] {
    will-change: transform !important;
    transform: translateZ(0) !important;
  }

  /* Reduce backdrop filters on low-end devices */
  @media (max-resolution: 150dpi) {
    .eh-panel,
    .nav-bottom,
    .notification-toast {
      backdrop-filter: none !important;
      -webkit-backdrop-filter: none !important;
    }
  }
}

/* Gesture-specific styles */
.touch-feedback {
  position: relative;
  overflow: hidden;
}

.touch-feedback::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.3s ease, height 0.3s ease;
  pointer-events: none;
}

.touch-feedback:active::after {
  width: 100px;
  height: 100px;
}

/* Pinch zoom indicators */
.pinch-zoom-active {
  cursor: zoom-in !important;
}

.pinch-zoom-active * {
  pointer-events: none !important;
}

/* Long press visual feedback */
.long-press-active {
  animation: longPressRipple 0.5s ease-out !important;
}

@keyframes longPressRipple {
  0% {
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb), 0.4);
  }
  70% {
    box-shadow: 0 0 0 20px rgba(var(--accent-rgb), 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(var(--accent-rgb), 0);
  }
}

/* Swipe indicators */
.swipe-indicator {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  z-index: 1000;
}

.swipe-indicator.left {
  left: 20px;
}

.swipe-indicator.right {
  right: 20px;
}

.swipe-indicator.visible {
  opacity: 1;
}

/* Mobile onboarding adjustments */
@media (max-width: 768px) {
  .onboarding-modal {
    margin: 16px !important;
    border-radius: 20px !important;
    padding: 24px 20px !important;
  }

  .onboarding-modal button {
    min-height: 48px !important;
    padding: 12px 20px !important;
    border-radius: 12px !important;
    font-size: 16px !important;
  }

  .onboarding-progress {
    height: 6px !important;
    border-radius: 3px !important;
  }
}

/* Mobile keyboard help */
@media (max-width: 768px) {
  .keyboard-help {
    padding: 20px !important;
    font-size: 14px !important;
  }

  .keyboard-help h2 {
    font-size: 20px !important;
    margin-bottom: 16px !important;
  }

  .keyboard-help dl {
    grid-template-columns: 1fr !important;
    gap: 8px !important;
  }

  .keyboard-help dt {
    margin-bottom: 4px !important;
  }

  .keyboard-help kbd {
    font-size: 11px !important;
    padding: 3px 6px !important;
  }
}